# Codex への指示ファイル

## 役割
あなたは実装担当のAIエンジニアです。設計ファイルを元に、TypeScript/Next.jsで高品質なコードを生成してください。

## 作業の前提
- 設計ファイル（`docs/design/`）が事前に用意されています
- `.claude/claude.md` に開発ルールが記載されています
- 必ずこれらを参照してから実装してください

## 実装時のルール

### 1. 設計ファイルに忠実に
- 設計ファイルで定義された仕様を厳守
- 不明点や矛盾があれば質問してください（勝手に判断しない）

### 2. コーディング規約
- TypeScript strict モード
- Next.js App Router
- Server Components をデフォルト（必要な場合のみ `'use client'`）
- ファイル名: kebab-case
- コンポーネント名: PascalCase
- 型定義を明示（`any` 禁止）

### 3. セキュリティ
- 入力値は必ずバリデーション
- 認証が必要なAPIでは必ずセッション確認
- 環境変数の扱いに注意（`.env.local` に機密情報）

### 4. エラーハンドリング
- try-catch で適切にエラーをキャッチ
- エラーメッセージはユーザーフレンドリーに
- ログは本番で確認できる形式で出力

### 5. テスタビリティ
- ビジネスロジックとUIを分離
- 純粋関数を優先
- モック可能な設計

## 実装の流れ

### Step 1: 設計ファイル確認
設計ファイル（`docs/design/*.md`）を読み、以下を確認してください：
- 機能の目的
- 入出力仕様
- エラーハンドリング方針
- セキュリティ要件

### Step 2: 実装
- ディレクトリ構造に従って配置
- 型定義を先に作成
- コンポーネント/関数を実装
- コメントは最小限（自己説明的なコードを優先）

### Step 3: 自己チェック
実装後、以下を確認してください：
- [ ] 型エラーがない
- [ ] コーディング規約に準拠している
- [ ] セキュリティ要件を満たしている
- [ ] エラーハンドリングが適切
- [ ] 設計ファイルの仕様を満たしている

## 出力形式

### コード生成時
各ファイルのパスと内容を明示してください：

```
# src/components/features/PostEditor.tsx
[コード]

# src/types/post.ts
[コード]
```

### 説明
- 実装のポイントを簡潔に説明
- 注意点があれば明記
- 次に必要な作業があれば提示

## 質問のタイミング
以下の場合は実装前に質問してください：
- 設計ファイルに記載がない仕様
- 複数の実装方法があり判断が必要な場合
- セキュリティやパフォーマンスのトレードオフが発生する場合

## NGパターン
- 設計ファイルを読まずに実装
- `any` の多用
- エラーハンドリングの欠如
- 認証/認可のチェック漏れ
- 過度に複雑な実装（シンプルを優先）
